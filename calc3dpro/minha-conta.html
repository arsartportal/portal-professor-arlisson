<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Minha Conta ‚Ä¢ Calc3D Pro</title>

<style>
:root{
  --azul:#2563eb;
  --cinza:#64748b;
  --cinza-claro:#e5e7eb;
  --bg:#f1f5f9;
  --card:#ffffff;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:"Segoe UI",Arial,sans-serif;
  background:var(--bg);
  color:#020617;
}

/* HEADER */
header{
  background:#fff;
  padding:18px 36px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid var(--cinza-claro);
}
.brand{
  display:flex;
  align-items:center;
  gap:12px;
  font-size:18px;
  font-weight:600;
  color:var(--azul);
}
.brand img{height:36px}
header a{
  text-decoration:none;
  color:var(--cinza);
  font-size:14px;
}

/* CONTAINER */
.container{
  max-width:900px;
  margin:40px auto;
  padding:0 20px;
}

h2{
  color:var(--azul);
  margin-bottom:20px;
}

/* CARD */
.card{
  background:var(--card);
  padding:30px;
  border-radius:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.06);
  margin-bottom:30px;
}

.grid-2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}

label{
  font-weight:600;
  font-size:14px;
}

input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid var(--cinza-claro);
  margin-top:6px;
  font-size:14px;
}

button{
  padding:14px 18px;
  border:none;
  border-radius:12px;
  background:var(--azul);
  color:#fff;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}

/* PLANO */
.plano{
  background:#f1f5f9;
  padding:20px;
  border-radius:12px;
}
.plano strong{
  color:var(--azul);
}
</style>
</head>

<body>

<!-- üîê FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCs6AGz_yGwLwbMuWQLMkUv0-IJZ84IT2M",
  authDomain: "calculadora---3d.firebaseapp.com",
  projectId: "calculadora---3d",
  storageBucket: "calculadora---3d.firebasestorage.app",
  messagingSenderId: "53725959441",
  appId: "1:53725959441:web:2f83316aa37380da0aa8b0"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let uid = null;

onAuthStateChanged(auth, async user => {
  if (!user) {
    location.href = "login.html";
    return;
  }

  uid = user.uid;
  email.value = user.email;

  const ref = doc(db, "users", uid, "profile", "dados");
  const snap = await getDoc(ref);

  if (snap.exists()) {
    const d = snap.data();
    nome.value = d.nome || "";
    empresa.value = d.empresa || "";
    telefone.value = d.telefone || "";
    maquina.value = d.maquina || "";
    kwh.value = d.kwh || "";
    lucro.value = d.lucro || "";
  }
});
console.log("Script Minha Conta carregado ‚úÖ")
window.salvarConta = async () => {
  console.log("Clique no bot√£o Salvar ‚úîÔ∏è");
  if (!uid) {
    alert("Usu√°rio n√£o autenticado.");
    return;
  }

  try {
    const dados = {
      nome: nome.value,
      empresa: empresa.value,
      telefone: telefone.value,
      maquina: maquina.value,
      kwh: kwh.value,
      lucro: lucro.value,
      atualizadoEm: new Date()
    };

    await setDoc(
      doc(db, "users", uid, "profile", "dados"),
      dados
    );

    alert("Dados salvos com sucesso!");
  } catch (erro) {
    console.error("Erro ao salvar dados:", erro);
    alert("Erro ao salvar os dados. Veja o console.");
  }
};


</script>

<header>
  <div class="brand">
    <img src="assets/img/logo.png">
    <span>Calc3D Pro</span>
  </div>
  <a href="dashboard.html">‚Üê Voltar</a>
</header>

<div class="container">

  <h2>Minha Conta</h2>

  <!-- DADOS DO USU√ÅRIO -->
  <div class="card">
    <h3>Dados do usu√°rio</h3>
    <div class="grid-2">
      <div>
        <label>Nome</label>
        <input id="nome" placeholder="Seu nome">
      </div>
      <div>
        <label>E-mail</label>
        <input id="email" disabled>
      </div>
    </div>
  </div>

  <!-- DADOS DA EMPRESA -->
  <div class="card">
    <h3>Empresa</h3>
    <div class="grid-2">
      <div>
        <label>Nome da empresa</label>
        <input id="empresa" placeholder="Ex: Impress√µes 3D Jo√£o">
      </div>
      <div>
        <label>Telefone</label>
        <input id="telefone" placeholder="(00) 00000-0000">
      </div>
    </div>
  </div>

  <!-- CONFIGURA√á√ïES -->
  <div class="card">
    <h3>Configura√ß√µes padr√£o</h3>
    <div class="grid-2">
      <div>
        <label>M√°quina (R$/h)</label>
        <input id="maquina" placeholder="5">
      </div>
      <div>
        <label>kWh (R$)</label>
        <input id="kwh" placeholder="0,50">
      </div>
      <div>
        <label>Lucro padr√£o (%)</label>
        <input id="lucro" placeholder="30">
      </div>
    </div>
  </div>

  <!-- PLANO -->
  <div class="card plano">
    <strong>Plano atual:</strong> Free<br>
    Recursos b√°sicos ativos<br><br>
    <em>Em breve: upgrade para Pro</em>
  </div>

  <button type="button" onclick="salvarConta()">
  Salvar altera√ß√µes
</button>

</div>

</body>
</html>
