<!DOCTYPE html>
<html lang="pt-br">

<head>
  <!-- =========================
       META / CONFIGURA√á√ïES
  ========================== -->
  <meta charset="UTF-8">
  <title>Portal do Professor Arlisson ‚Ä¢ F√≠sica</title>

    <!-- Estilo global do portal -->
<link rel="stylesheet" href="css/style.css">

<!-- Estilo espec√≠fico do m√≥dulo F√≠sica -->
<link rel="stylesheet" href="css/fisica.css">
</head>

<!-- 
  data-theme controla o modo claro/escuro
-->
<body data-theme="light">

<!-- =========================
     HEADER / HUD SUPERIOR
========================== -->
<header class="header">

  <!-- MINI HUD DO USU√ÅRIO -->
  <div class="mini-hud">

    <img
      id="patente-img"
      class="mini-patente"
      src=""
      alt="Patente do usu√°rio"
    />

    <div class="mini-xp">
      <div id="xp-preenchimento"></div>
    </div>

    <div class="mini-detalhes">

      <img
        id="patente-img-detalhe"
        class="patente-grande"
        src=""
        alt="Patente detalhada"
      />

      <div class="info-texto">
        <strong>N√≠vel <span id="nivel-usuario">0</span></strong>
        <span id="xp-texto">XP 0 / 100</span>
      </div>

    </div>
  </div>

  <!-- T√çTULO CENTRAL -->
  <div class="header-centro">
    <h1 class="portal-title">
      <span class="portal-brand">Portal</span>
      <span class="portal-name">Professor Arlisson</span>
    </h1>
    <p>Materiais de F√≠sica e Matem√°tica ‚Ä¢ Ensino M√©dio e EJA (2026)</p>
  </div>

  <!-- A√á√ïES -->
  <div class="header-direita">
    <div class="header-botoes">
      <button id="toggle-tema" title="Alternar tema">üåô</button>
      <button onclick="sair()">Sair</button>
    </div>
  </div>

</header>

<!-- =========================
     CONTE√öDO PRINCIPAL
========================== -->
<main data-modulo="fisica">

  <!-- T√çTULO DO M√ìDULO -->
  <section class="welcome-user">
    <h2>
      üìò F√≠sica ‚Äî
      <span id="nome-usuario">Aluno</span>, bora aprender? ‚ö°
    </h2>
  </section>

  <!-- AQUI ENTRAR√ÉO:
       ‚Ä¢ Conte√∫dos
       ‚Ä¢ Listas
       ‚Ä¢ V√≠deos
       ‚Ä¢ PDFs
       ‚Ä¢ Exerc√≠cios
  -->

  <section class="trilhas">
  <h3>üìö Trilhas de Aprendizagem</h3>

  <!-- Aqui o JS vai inserir os cards -->
  <div id="lista-trilhas" class="cards-trilhas"></div>
</section>

</main>

<!-- =========================
     SCRIPT: LOGOUT
========================== -->
<script>
function sair() {
  localStorage.clear();

  if (window.firebase && firebase.auth) {
    firebase.auth().signOut().finally(() => {
      window.location.href = "index.html";
    });
  } else {
    window.location.href = "index.html";
  }
}
</script>

<!-- =========================
     SCRIPTS DO SISTEMA
========================== -->
<script type="module" src="js/auth-guard.js"></script>
<script type="module" src="js/perfil.js"></script>
<script src="js/tema.js"></script>
<script type="module" src="js/hud.js"></script>
<script src="js/gamificacao.js"></script>
<!-- JS ESPEC√çFICO DA F√çSICA -->
<script type="module" src="js/fisica.js"></script>


<!-- =========================
     LEVEL UP OVERLAY
========================== -->
<div id="levelup-overlay">
  <div class="levelup-box">
    <div class="levelup-title">LEVEL UP</div>
    <div class="levelup-level">
      N√≠vel <span id="levelup-nivel">0</span>
    </div>
  </div>
</div>

<script type="module">
  import { adicionarXP } from "./js/xp.js";

  // XP por entrar no m√≥dulo F√≠sica (1x por dia)
  adicionarXP(100, "Acesso √† F√≠sica");
</script>

<script type="module">
  import { adicionarXP } from "./js/xp.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";
  import { app } from "./js/firebase.js";

  const auth = getAuth(app);
  const db = getFirestore(app);

  onAuthStateChanged(auth, async (user) => {
    if (!user) return;

    // üîç Verifica se veio de um checkpoint
    const raw = localStorage.getItem("checkpointConcluido");
    if (!raw) return;

    const evento = JSON.parse(raw);

    // Seguran√ßa b√°sica
    if (!evento.trilha || !evento.xp) return;

    // üî• XP REAL (Firestore)
    await adicionarXP(evento.xp, `checkpoint_${evento.trilha}`);

    // üî• XP VISUAL + LEVEL UP
    if (window.adicionarXPVisual) {
      window.adicionarXPVisual(evento.xp);
    }

    // üßπ Limpa evento (anti-duplica√ß√£o)
    localStorage.removeItem("checkpointConcluido");
  });
</script>
</body>
</html>
